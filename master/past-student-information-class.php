<?php class Past_Student_Information_Class extends DataBase{		/*Add Student information*/		function Add_Past_Student_Information(){							$error = "";						if(empty($_POST['stdGrNo']))			{				$error.= "Please enter GR No.<br>";				}			if(empty($_POST['stdSurname']))			{				$error.= "Please enter surname.<br>";				}			if(empty($_POST['stdStudentName']))			{				$error.= "Please enter student name.<br>";				}			if(empty($_POST['stdFatherName']))			{				$error.= "Please enter father name.<br>";				}			if(empty($_POST['stdAddress']))			{				$error.= "Please enter address.<br>";				}			if(empty($_POST['stdDistrict']))			{				$error.= "Please enter district name.<br>";				}			if(empty($_POST['stdGender']))			{				$error.= "Please select gender.<br>";				}			if(empty($_POST['stdBirthDate']))			{				$error.= "Please select birth date.<br>";				}			if(empty($_POST['stdBirthPlace']))			{				$error.= "Please enter birth place.<br>";				}			if(empty($_POST['stdCast']))			{				$error.= "Please enter cast.<br>";				}			if(empty($_POST['stdReligion']))			{				$error.= "Please enter religion.<br>";				}			if(empty($_POST['stdCategory']))			{				$error.= "Please select category.<br>";				}			if(empty($_POST['stdAdmissionStandard']))			{				$error.= "Please select admission standard.<br>";				}			if(empty($_POST['stdAdmissionClass']))			{				$error.= "Please select admission class.<br>";				}			if(empty($_POST['stdCurrentStandard']))			{				$error.= "Please select leaving standard.<br>";				}			if(empty($_POST['stdCurrentClass']))			{				$error.= "Please select current class.<br>";				}						else			{					 $column=" stdGrNo='".Common_Nijsol_Class::Set_Value($_POST['stdGrNo'])."' and schCode='".Common_Nijsol_Class::Get_Session('schCode')."'";					 $field = 'count(stdGrNo) as total';					$result=$this->Get_Rows(DB_PREFIX."student",$column,$field);										if($result[0]['total'] > 0)						{						$error.="Student GR number already exists.<br>";						}			}									if(!empty($_POST['stdEmail']))			{				if (!filter_var($_POST['stdEmail'], FILTER_VALIDATE_EMAIL)) {				  $error.= "Invalid email format.<br>";				}			}									if(empty($error))			{				$column=array(				  'stdGrNo'=>Common_Nijsol_Class::Set_Value($_POST['stdGrNo']),				  'stdSurname'=>Common_Nijsol_Class::Set_Value($_POST['stdSurname']),				  'stdStudentName'=>Common_Nijsol_Class::Set_Value($_POST['stdStudentName']),				  'stdFatherName'=>Common_Nijsol_Class::Set_Value($_POST['stdFatherName']),				  'stdMotherName'=>Common_Nijsol_Class::Set_Value($_POST['stdMotherName']),				  'stdAddress'=>Common_Nijsol_Class::Set_Value($_POST['stdAddress']),				  'stdTaluka'=>Common_Nijsol_Class::Set_Value($_POST['stdTaluka']),				  'stdCity'=>Common_Nijsol_Class::Set_Value($_POST['stdCity']),				  'stdDistrict'=>Common_Nijsol_Class::Set_Value($_POST['stdDistrict']),				  'stdPinCode'=>Common_Nijsol_Class::Set_Value($_POST['stdPinCode']),				  'stdGender'=>Common_Nijsol_Class::Set_Value($_POST['stdGender']),				  'stdBloodGroup'=>Common_Nijsol_Class::Set_Value($_POST['stdBloodGroup']),				  'stdMobileNo'=>Common_Nijsol_Class::Set_Value($_POST['stdMobileNo']),				  'stdHomeNo'=>Common_Nijsol_Class::Set_Value($_POST['stdHomeNo']),				  'stdFatherOccupation'=>Common_Nijsol_Class::Set_Value($_POST['stdFatherOccupation']),				  'stdMotherOccupation'=>Common_Nijsol_Class::Set_Value($_POST['stdMotherOccupation']),				  'stdBirthDate'=>Common_Nijsol_Class::Convert_Date_To_Mysql_Format($_POST['stdBirthDate']),				  'stdBirthPlace'=>Common_Nijsol_Class::Set_Value($_POST['stdBirthPlace']),				  'stdCast'=>Common_Nijsol_Class::Set_Value($_POST['stdCast']),				  'stdReligion'=>Common_Nijsol_Class::Set_Value($_POST['stdReligion']),				  'stdCategory'=>Common_Nijsol_Class::Set_Value($_POST['stdCategory']),				  'stdEtc'=>Common_Nijsol_Class::Set_Value($_POST['stdEtc']),				  'stdAdmissionStandard'=>Common_Nijsol_Class::Set_Value($_POST['stdAdmissionStandard']),				  'stdAdmissionClass'=>Common_Nijsol_Class::Set_Value($_POST['stdAdmissionClass']),				  'stdAdmissionDate'=>Common_Nijsol_Class::Convert_Date_To_Mysql_Format($_POST['stdAdmissionDate']),				  'stdCurrentStandard'=>Common_Nijsol_Class::Set_Value($_POST['stdCurrentStandard']),				  'stdCurrentClass'=>Common_Nijsol_Class::Set_Value($_POST['stdCurrentClass']),				  'stdLastSchool'=>Common_Nijsol_Class::Set_Value($_POST['stdLastSchool']),				  'stdPhysicalHandicap'=>Common_Nijsol_Class::Set_Value($_POST['stdPhysicalHandicap']),				  'stdNative'=>Common_Nijsol_Class::Set_Value($_POST['stdNative']),				  'stdEmail'=>Common_Nijsol_Class::Set_Value($_POST['stdEmail']),				  'stdNationality'=>Common_Nijsol_Class::Set_Value($_POST['stdNationality']),				  'stdPhoto'=>Common_Nijsol_Class::Set_Value(Common_Nijsol_Class::Get_Session('student-photo')),				  'stdReasonFeeException'=>Common_Nijsol_Class::Set_Value($_POST['stdReasonFeeException']),				  'stdActive'=>Common_Nijsol_Class::Set_Value("0"),				  'schCode'=>Common_Nijsol_Class::Get_Session('schCode'),				  'usrId'=>Common_Nijsol_Class::Get_Session(ADMIN_LOGIN_USER_ID)				  );					  				$result=$this->Insert_Row(DB_PREFIX."student",$column);								if(!empty($result))					{															$column=array(					  'pstdStudentId'=>Common_Nijsol_Class::Set_Value($result),					  'pstdLCNo'=>Common_Nijsol_Class::Set_Value($_POST['pstdLCNo']),					  'pstdLeavingDate'=>Common_Nijsol_Class::Convert_Date_To_Mysql_Format($_POST['pstdLeavingDate']),					  'pstdReason'=>Common_Nijsol_Class::Set_Value($_POST['pstdReason']),					  'pstdFromWhenLeaving'=>Common_Nijsol_Class::Convert_Date_To_Mysql_Format($_POST['pstdFromWhenLeaving']),					  'pstdRemarks'=>Common_Nijsol_Class::Set_Value($_POST['pstdRemarks']),					  'pstdProgress'=>Common_Nijsol_Class::Set_Value($_POST['pstdProgress']),					  'pstdConduct'=>Common_Nijsol_Class::Set_Value($_POST['pstdConduct']),					  'pstdLCIssue'=>Common_Nijsol_Class::Set_Value($_POST['pstdLCIssue']),					  'pstdLCIssueDate'=>Common_Nijsol_Class::Convert_Date_To_Mysql_Format($_POST['pstdLCIssueDate']),					  'pstdPresenceDay'=>Common_Nijsol_Class::Set_Value($_POST['pstdPresenceDay']),					  'pstdWorkingDay'=>Common_Nijsol_Class::Set_Value($_POST['pstdWorkingDay']),					  'schCode'=>Common_Nijsol_Class::Get_Session('schCode'),					  'usrId'=>Common_Nijsol_Class::Get_Session(ADMIN_LOGIN_USER_ID)					  );						  					$result=$this->Insert_Row(DB_PREFIX."past_student",$column);																					Common_Nijsol_Class::Set_Session('msg','Add student information successfully.');					Common_Nijsol_Class::Set_Session('error_success','success');					Common_Nijsol_Class::Redirect_To(MASTER_URL.'past-student-information-manage.php');					}				else				{					Common_Nijsol_Class::Set_Session('msg','Invalid data');					Common_Nijsol_Class::Set_Session('error_success','error');					Common_Nijsol_Class::Redirect_To(MASTER_URL.'past-student-information-add-edit.php?mode=add');				}			}			else			{				Common_Nijsol_Class::Set_Session('msg',$error);				Common_Nijsol_Class::Set_Session('error_success','error');				Common_Nijsol_Class::Redirect_To(MASTER_URL.'past-student-information-add-edit.php?mode=add');				}		}							/*Edit student information*/		

function Edit_Past_Student_Information(){							$error = "";						if(empty($_POST['stdGrNo']))			{				$error.= "Please enter GR no.<br>";				}			if(empty($_POST['stdSurname']))			{				$error.= "Please enter surname.<br>";				}			if(empty($_POST['stdStudentName']))			{				$error.= "Please enter student name.<br>";				}			if(empty($_POST['stdFatherName']))			{				$error.= "Please enter father name.<br>";				}			if(empty($_POST['stdAddress']))			{				$error.= "Please enter address.<br>";				}			if(empty($_POST['stdDistrict']))			{				$error.= "Please enter district name.<br>";				}			if(empty($_POST['stdGender']))			{				$error.= "Please select gender.<br>";				}			if(empty($_POST['stdBirthDate']))			{				$error.= "Please select birth date.<br>";				}			if(empty($_POST['stdBirthPlace']))			{				$error.= "Please enter birth place.<br>";				}			if(empty($_POST['stdCast']))			{				$error.= "Please enter cast.<br>";				}			if(empty($_POST['stdReligion']))			{				$error.= "Please enter religion.<br>";				}			if(empty($_POST['stdCategory']))			{				$error.= "Please select category.<br>";				}			if(empty($_POST['stdAdmissionStandard']))			{				$error.= "Please select admission standard.<br>";				}			if(empty($_POST['stdAdmissionClass']))			{				$error.= "Please select admission class.<br>";				}			if(empty($_POST['stdCurrentStandard']))			{				$error.= "Please select leaving standard.<br>";				}			if(empty($_POST['stdCurrentClass']))			{				$error.= "Please select current class.<br>";				}						else			{					$column=" stdGrNo='".Common_Nijsol_Class::Set_Value($_POST['stdGrNo'])."' and schCode='".Common_Nijsol_Class::Get_Session('schCode')."' and stdId!='".Common_Nijsol_Class::Set_Value($_POST['id'])."'";					$field = 'count(stdGrNo) as total';					$result=$this->Get_Rows(DB_PREFIX."student",$column,$field);										if($result[0]['total'] > 0)						{						$error.="Student GR number already exists.<br>";						}			}												if(empty($error))			{				$column=array(				  'stdGrNo'=>Common_Nijsol_Class::Set_Value($_POST['stdGrNo']),				  'stdSurname'=>Common_Nijsol_Class::Set_Value($_POST['stdSurname']),				  'stdStudentName'=>Common_Nijsol_Class::Set_Value($_POST['stdStudentName']),				  'stdFatherName'=>Common_Nijsol_Class::Set_Value($_POST['stdFatherName']),				  'stdMotherName'=>Common_Nijsol_Class::Set_Value($_POST['stdMotherName']),				  'stdAddress'=>Common_Nijsol_Class::Set_Value($_POST['stdAddress']),				  'stdTaluka'=>Common_Nijsol_Class::Set_Value($_POST['stdTaluka']),				  'stdCity'=>Common_Nijsol_Class::Set_Value($_POST['stdCity']),				  'stdDistrict'=>Common_Nijsol_Class::Set_Value($_POST['stdDistrict']),				  'stdPinCode'=>Common_Nijsol_Class::Set_Value($_POST['stdPinCode']),				  'stdGender'=>Common_Nijsol_Class::Set_Value($_POST['stdGender']),				  'stdBloodGroup'=>Common_Nijsol_Class::Set_Value($_POST['stdBloodGroup']),				  'stdMobileNo'=>Common_Nijsol_Class::Set_Value($_POST['stdMobileNo']),				  'stdHomeNo'=>Common_Nijsol_Class::Set_Value($_POST['stdHomeNo']),				  'stdFatherOccupation'=>Common_Nijsol_Class::Set_Value($_POST['stdFatherOccupation']),				  'stdMotherOccupation'=>Common_Nijsol_Class::Set_Value($_POST['stdMotherOccupation']),				  'stdBirthDate'=>Common_Nijsol_Class::Convert_Date_To_Mysql_Format($_POST['stdBirthDate']),				  'stdBirthPlace'=>Common_Nijsol_Class::Set_Value($_POST['stdBirthPlace']),				  'stdCast'=>Common_Nijsol_Class::Set_Value($_POST['stdCast']),				  'stdReligion'=>Common_Nijsol_Class::Set_Value($_POST['stdReligion']),				  'stdCategory'=>Common_Nijsol_Class::Set_Value($_POST['stdCategory']),				  'stdEtc'=>Common_Nijsol_Class::Set_Value($_POST['stdEtc']),				  'stdAdmissionStandard'=>Common_Nijsol_Class::Set_Value($_POST['stdAdmissionStandard']),				  'stdAdmissionClass'=>Common_Nijsol_Class::Set_Value($_POST['stdAdmissionClass']),				  'stdAdmissionDate'=>Common_Nijsol_Class::Convert_Date_To_Mysql_Format($_POST['stdAdmissionDate']),				  'stdCurrentStandard'=>Common_Nijsol_Class::Set_Value($_POST['stdCurrentStandard']),				  'stdCurrentClass'=>Common_Nijsol_Class::Set_Value($_POST['stdCurrentClass']),				  'stdLastSchool'=>Common_Nijsol_Class::Set_Value($_POST['stdLastSchool']),				  'stdPhysicalHandicap'=>Common_Nijsol_Class::Set_Value($_POST['stdPhysicalHandicap']),				  'stdNative'=>Common_Nijsol_Class::Set_Value($_POST['stdNative']),				  'stdEmail'=>Common_Nijsol_Class::Set_Value($_POST['stdEmail']),				  'stdNationality'=>Common_Nijsol_Class::Set_Value($_POST['stdNationality']),				  'stdPhoto'=>Common_Nijsol_Class::Set_Value(Common_Nijsol_Class::Get_Session('student-photo')),				  'stdReasonFeeException'=>Common_Nijsol_Class::Set_Value($_POST['stdReasonFeeException']),				  'usrId'=>Common_Nijsol_Class::Get_Session(ADMIN_LOGIN_USER_ID)				  );								$where = " stdId='".$_POST['id']."' and schCode='".Common_Nijsol_Class::Get_Session('schCode')."'";				$result=$this->Update_Row(DB_PREFIX."student",$column, $where);																				$find_student="select count(pstdId) from past_student where pstdStudentId='".$_POST['id']."' and schCode='".Common_Nijsol_Class::Get_Session('schCode')."' ";					if(!empty($find_student))					{						$column=array(						  'pstdLCNo'=>Common_Nijsol_Class::Set_Value($_POST['pstdLCNo']),						  'pstdLeavingDate'=>Common_Nijsol_Class::Convert_Date_To_Mysql_Format($_POST['pstdLeavingDate']),						  'pstdReason'=>Common_Nijsol_Class::Set_Value($_POST['pstdReason']),						  'pstdFromWhenLeaving'=>Common_Nijsol_Class::Convert_Date_To_Mysql_Format($_POST['pstdFromWhenLeaving']),						  'pstdRemarks'=>Common_Nijsol_Class::Set_Value($_POST['pstdRemarks']),						  'pstdProgress'=>Common_Nijsol_Class::Set_Value($_POST['pstdProgress']),						  'pstdConduct'=>Common_Nijsol_Class::Set_Value($_POST['pstdConduct']),						  'pstdLCIssue'=>Common_Nijsol_Class::Set_Value($_POST['pstdLCIssue']),						  'pstdLCIssueDate'=>Common_Nijsol_Class::Convert_Date_To_Mysql_Format($_POST['pstdLCIssueDate']),						  'pstdPresenceDay'=>Common_Nijsol_Class::Set_Value($_POST['pstdPresenceDay']),						  'pstdWorkingDay'=>Common_Nijsol_Class::Set_Value($_POST['pstdWorkingDay']),						  'schCode'=>Common_Nijsol_Class::Get_Session('schCode'),						  'usrId'=>Common_Nijsol_Class::Get_Session(ADMIN_LOGIN_USER_ID)					  	);						 $where = " pstdStudentId='".$_POST['id']."' and schCode='".Common_Nijsol_Class::Get_Session('schCode')."' and usrId='".Common_Nijsol_Class::Get_Session(ADMIN_LOGIN_USER_ID)."'";						$result=$this->Update_Row(DB_PREFIX."past_student",$column, $where);

$column=array('tblRecordId'=>Common_Nijsol_Class::Set_Value($_POST['id']),					  'tblName'=>'pgs_past_student',					  
'tblTitle'=>'Edit Past Student Information',					  
'editMessage'=>Common_Nijsol_Class::Set_Value($_POST['editMessage']),
'editDate'=>date("Y-m-d"),				  
'schCode'=>Common_Nijsol_Class::Get_Session('schCode'),					  
'usrId'=>Common_Nijsol_Class::Get_Session(ADMIN_LOGIN_USER_ID));					  					$result=$this->Insert_Row(DB_PREFIX."edit_message",$column);

}										

if(empty($find_student))					{						$column=array(						  'pstdStudentId'=>Common_Nijsol_Class::Set_Value($result),						  'pstdLCNo'=>Common_Nijsol_Class::Set_Value($_POST['pstdLCNo']),						  'pstdLeavingDate'=>Common_Nijsol_Class::Convert_Date_To_Mysql_Format($_POST['pstdLeavingDate']),						  'pstdReason'=>Common_Nijsol_Class::Set_Value($_POST['pstdReason']),						  'pstdFromWhenLeaving'=>Common_Nijsol_Class::Convert_Date_To_Mysql_Format($_POST['pstdFromWhenLeaving']),						  'pstdRemarks'=>Common_Nijsol_Class::Set_Value($_POST['pstdRemarks']),						  'pstdProgress'=>Common_Nijsol_Class::Set_Value($_POST['pstdProgress']),						  'pstdConduct'=>Common_Nijsol_Class::Set_Value($_POST['pstdConduct']),						  'pstdLCIssue'=>Common_Nijsol_Class::Set_Value($_POST['pstdLCIssue']),						  'pstdLCIssueDate'=>Common_Nijsol_Class::Convert_Date_To_Mysql_Format($_POST['pstdLCIssueDate']),						  'pstdPresenceDay'=>Common_Nijsol_Class::Set_Value($_POST['pstdPresenceDay']),						  'pstdWorkingDay'=>Common_Nijsol_Class::Set_Value($_POST['pstdWorkingDay']),						  'schCode'=>Common_Nijsol_Class::Get_Session('schCode'),						  'usrId'=>Common_Nijsol_Class::Get_Session(ADMIN_LOGIN_USER_ID)					  	);						  						$result=$this->Insert_Row(DB_PREFIX."past_student",$column);					}															Common_Nijsol_Class::Set_Session('msg','Edit student information successfully.');					Common_Nijsol_Class::Set_Session('error_success','success');					Common_Nijsol_Class::Redirect_To(MASTER_URL.'past-student-information-manage.php');				}			else			{				Common_Nijsol_Class::Set_Session('msg',$error);				Common_Nijsol_Class::Set_Session('error_success','error');				Common_Nijsol_Class::Redirect_To(MASTER_URL.'past-student-information-add-edit.php?id='.$_POST['id'].'&mode=edit');				}		}}